<!doctypehtml>
<html lang=en-us>
    <head>
        <meta charset=utf-8>
        <meta content="text/html; charset=utf-8"http-equiv=Content-Type>
        <title>NES</title>
        <link rel="stylesheet" href="styles.css"/>
    </head>
    <body>
        <div id="maingrid">
            <div>
                <div id="nes"></div>
                <div id="gamepads"></div>
                <div id=status>Downloading...</div>
                <div id=spinner style=overflow:visible>Spinnin and that.</div>
                <progress hidden id=progress max=100 value=0></progress>
                
                <div>
                    <canvas id=canvas oncontextmenu=event.preventDefault() tabindex=-1></canvas>
                    <textarea id=output rows=8></textarea>
                </div>
            </div>
            <div>
                <h1>????: a Famicom/NES Emulator</h1>
                <h2>How do I play it!?</h2>
                <p>Click a game from the list below!</p>
                <h2>About</h2>
                <p>This is an emulator of the Nintendo Famicom/NES, allowing you to run software made for these platforms within a web browser, using keyboard, game pad, or touch screen for input. It is work in progress, will not run everything, and is lacking accuracy in some areas. To run software, you can load a file from your device (in the usual iNes format), or choose from one of the legally permitted ones below.</p>
                <h2>Instructions</h2>
                <p>Load something, then switch to full screen by pressing on the small screen. Touch controls are on-screen. The keyboard keys are mapped as:</p>
                <ul>
                    <li>NES "+Control Pad" : Arrow/Cursor Keys / WASD</li>
                    <li>NES "A" button : X / Space</li>
                    <li>NES "B" button : Z / Enter</li>
                    <li>NES "Start" button : V / E</li>
                    <li>NES "Select" button : C / Q</li>
                </ul>
                <div id="roms"></div>
            </div>
        </div>



        
        
        <script>
            var statusElement=document.getElementById("status"),
            progressElement=document.getElementById("progress"),
            spinnerElement=document.getElementById("spinner"),
            Module={
                print:function(){
                    var e=document.getElementById("output");
                    return e&&(e.value=""),
                    (...t)=>{
                        var n=t.join(" ");
                        console.log(n),
                        e&&(e.value+=n+"\n",e.scrollTop=e.scrollHeight)
                    }
                }(),
                canvas:(()=>{
                    var e=document.getElementById("canvas");
                    return e.addEventListener("webglcontextlost",(e=>{
                        alert("WebGL context lost. You will need to reload the page."),e.preventDefault()
                    }), !1),e
                })(),
                setStatus:e=>{
                    if(Module.setStatus.last
                    ||(Module.setStatus.last={
                        time:Date.now(),text:""
                    }),e!==Module.setStatus.last.text){
                        var t=e.match(/([^(]+)\((\d+(\.\d+)?)\/(\d+)\)/),n=Date.now();
                        t&&n-Module.setStatus.last.time<30
                        ||(Module.setStatus.last.time=n,
                            Module.setStatus.last.text=e,
                            t?(
                                e=t[1],
                                progressElement.value=100*parseInt(t[2]),
                                progressElement.max=100*parseInt(t[4]),
                                progressElement.hidden=!1,
                                spinnerElement.hidden=!1
                            )
                            :(
                                progressElement.value=null,
                                progressElement.max=null,
                                progressElement.hidden=!0,
                                e||(spinnerElement.hidden=!0)
                            )
                            ,statusElement.innerHTML=e
                        )
                    }
                },
                totalDependencies:0,            
                monitorRunDependencies:e=>{
                    this.totalDependencies=Math.max(this.totalDependencies,e),        
                    Module.setStatus(e?"Preparing... ("+(this.totalDependencies-e)+"/"+this.totalDependencies+")":"All downloads complete.")
                }
            };
            
            Module.setStatus("Downloading..."),
            
            window.onerror = ()=>{
                Module.setStatus("Exception thrown, see JavaScript console"),
                spinnerElement.style.display="none",
                Module.setStatus=e=>{
                    e&&console.error("[post-exception status] "+e)
                }
            }
        </script>
        <script async src=index.js></script>
        <script async type="module" src="main.js"></script>
    </body>
</html>